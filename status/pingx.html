<html>
<!-- <script type="text/javascript" src=""></script> -->
<script src="js/jquery-3.6.0.min.js"></script>
<script src="js/jquery-2.1.3.min.js"></script>
<script src="js/gstatic-charts-loader.js"></script>
<link rel="stylesheet" type="text/css" href="css/bootstrap.3.3.5.min.css"/>

<style>
body{
background: url(./img/potbs_bg.gif) repeat no-repeat top center black;

}
.col-xs-12.col-sm-8 {
    padding-top: 25px;
}
rect, g{
background-color: opacity: .5;
}

.container{
  
  opacity: 0.8;
  background-color: rgba(110, 103, 111, 0.44);
}
</style>




<div class="container" style="padding-top:30px;margin-top:50px">
<div class="form-group">
        <div class="input-group">
          <div class="btn-group" role="group">
            <button class="btn btn-info" id="cdn">CDN</button>
			<button class="btn btn-info" id="robertsserver">Roberts</button>
			<button class="btn btn-info" id="testserver">Test Server</button>
			
			
		
		
		<
			
            
          </div>
        </div>
      </div>
  <div id="linechart_material" style="opacity: .5;"></div>
  <div class="row">
    <div class="col-xs-12 col-sm-8">
      <div class="form-group">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">Address</span>
          <input type="text" class="form-control" id="address" value="208.70.79.72" />
        </div>
      </div>
      <div class="form-group">
        <div class="input-group">
          <div class="btn-group" role="group">
            <button class="btn btn-info" id="test">Test</button>
            <button class="btn btn-success" id="start">Start Ping Test</button>
            <button class="btn btn-danger" id="stop" disabled="true">Stop</button>
            <button class="btn btn-info" id="reset">Reset Chart</button>
          </div>
        </div>
      </div>
      <div class="form-group">
        <div class="input-group">
          <div class="btn-group" role="group">
            <button class="btn btn-default setaddress" address="https://www.google.com/favicon.ico">google.com</button>
            <button class="btn btn-default setaddress" address="https://facebook.com/favicon.ico">facebook.com</button>
          </div>
        </div>
      </div>
      <div class="form-group">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">Time (ms)</span>
          <input type="number" class="form-control" id="time" min="1000" value="2500" />
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    Credits: <a href="https://codepen.io/Hadik/pen/MVOVEq">Hadik</a> - <a href="https://www.bootstrapcdn.com/">Bootstrap</a> - <a href="https://www.google.com/jsapi">Google JSAPI / Gstatic Charts</a>
  </div>
</div>

<script>
var timer;
$('#test').click(test);
$('#robertsserver').click(robertsserver);
$('#cdn').click(cdn);
$('#testserver').click(testserver);
$('#start').click( function(){
  $(this).prop('disabled', true);
  $('#stop').prop('disabled', false);
  test();
  setTimer($('#time').val());
});
$('#stop').click( function(){
  $(this).prop('disabled', true);
  $('#start').prop('disabled', false);
  clearInterval(timer);
});
$('#reset').click( function(){ init(); });
$('.setaddress').click(function(){
  $('#address').val($(this).attr('address'));
  init();
});
$('#time').change(function() {
  console.log($('#time').val());
  if(timer){
    clearInterval(timer);
    setTimer($('#time').val());
  }
});

function setTimer(time){
  if(!time || time < 1000){
    time = 100;
  }

  timer = setInterval(test, time);
}



google.load('visualization', '1.1', {
  packages: ['line']
});
google.setOnLoadCallback(init);

var chart;
var data;
var options = {
  chart: {
    title: 'Ping test',
    animation: {
      duration: 7500,
      easing: 'out'
    }
  },
  height: 500
};
function init(){
  data = new google.visualization.DataTable();
  data.addColumn('number', '');
  data.addColumn('number', 'ms');
  
  data.addRows([[1, 1]]);
  chart = new google.charts.Line(document.getElementById('linechart_material'));
  drawChart();
}
function drawChart() {
  chart.draw(data, options);
}
function updateChart(dataset){
  data.addRow(dataset);
  drawChart();
}
var request_image = function(url) {
    return new Promise(function(resolve, reject) {
        var img = new Image();
        img.onload = function() { resolve(img); };
        img.onerror = function() { reject(url); };
        img.src = url + '?random-no-cache=' + Math.floor((1 + Math.random()) * 0x10000).toString(16);
    });
};
var ping = function(url, multiplier) {
    return new Promise(function(resolve, reject) {
        var start = (new Date()).getTime();
        var response = function() { 
            var delta = ((new Date()).getTime() - start);
            delta *= (multiplier || 1);
            resolve(delta); 
        };
        request_image(url).then(response).catch(response);
        
        // Set a timeout for max-pings, 5s.
        setTimeout(function() { reject(Error('Timeout')); }, 5000);
    });
};

function test(){
  
  ping('https://burningsea.com/favicon.ico').then(function(result) {
  console.log(address + 'Test 123: ' + result);
    updateChart([data.getNumberOfRows()+1,result]);
  }).catch(function(error) {
    updateChart([data.getNumberOfRows()+1,5000]);
  });
}
function cdn(){
  var address = $('#address').val();
  ping('https://cdn.visiononlinegames.com/potbs/POTBS_Installer.exe').then(function(result) {
  console.log('CDN: ' + result);
  }).catch(function(error) {
	console.log('CDN fail: ' + result + ' ' + ' ' + error);
  });
}
function robertsserver(){
  var address = $('#address').val();
  ping('http://208.70.79.72').then(function(result) {
  console.log('Roberts: ' + result);
    updateChart([data.getNumberOfRows()+1,result]);
  }).catch(function(error) {
    updateChart([data.getNumberOfRows()+1,5000]);
	console.log('Roberts fail: ' + result + ' ' + ' ' + error);
  });
}
function testserver(){
  var address = $('#address').val();
  ping(address).then(function(result) {
  console.log('Test Server: ' + result);
    updateChart([data.getNumberOfRows()+1,result]);
  }).catch(function(error) {
    updateChart([data.getNumberOfRows()+1,5000]);
	console.log('Test Server fail: ' + result + ' ' + ' ' + error);
  });
}
</script>
</html>